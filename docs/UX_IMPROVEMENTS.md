# omo-quota UX ä¼˜åŒ–æŠ¥å‘Š

## æ¦‚è¿°

æœ¬æŠ¥å‘Šè¯¦ç»†è¯´æ˜äº†å¯¹ omo-quota CLI å·¥å…·è¿›è¡Œçš„ç”¨æˆ·ä½“éªŒï¼ˆUXï¼‰ä¼˜åŒ–ï¼Œæ—¨åœ¨æå‡å·¥å…·çš„æ˜“ç”¨æ€§ã€å‹å¥½æ€§å’Œä¸“ä¸šæ€§ã€‚

## ä¼˜åŒ–æ¦‚è§ˆ

| ä¼˜åŒ–é¡¹ | ä¼˜å…ˆçº§ | çŠ¶æ€ | æ–‡ä»¶ |
|--------|--------|------|------|
| ç»“æ„åŒ–é”™è¯¯æ¶ˆæ¯ | P0 | âœ… å®Œæˆ | `src/utils/error-formatter.ts` |
| è¿›åº¦åé¦ˆç³»ç»Ÿ | P1 | âœ… å®Œæˆ | `src/utils/progress.ts` |
| äº¤äº’å¼å¼•å¯¼å‘å¯¼ | P2 | âœ… å®Œæˆ | `src/commands/wizard.ts` |
| æ’¤é”€/é‡åšæœºåˆ¶ | P3 | âœ… å®Œæˆ | `src/utils/undo-stack.ts`, `src/commands/undo.ts` |
| ç»Ÿä¸€è¾“å‡ºæ ¼å¼ | P4 | âœ… å®Œæˆ | `src/utils/output-formatter.ts` |

---

## 1. ç»“æ„åŒ–é”™è¯¯æ¶ˆæ¯ (P0)

### ä¼˜åŒ–å‰
```
âœ— ç­–ç•¥æ–‡ä»¶ä¸å­˜åœ¨: /Users/xxx/.config/opencode/strategies/strategy-2-balanced.jsonc
```

### ä¼˜åŒ–å
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš™ï¸ é…ç½®é”™è¯¯: ç­–ç•¥æ–‡ä»¶ä¸å­˜åœ¨                                  â”‚
â”‚ â”Œâ”€ é…ç½®æ–‡ä»¶ç›¸å…³çš„é—®é¢˜                                         â”‚
â”‚ â”‚                                                            â”‚
â”‚ â”‚ ğŸ’¡ è§£å†³æ–¹æ¡ˆ:                                               â”‚
â”‚ â”‚    1. è¿è¡Œåˆå§‹åŒ–ç”Ÿæˆç­–ç•¥æ¨¡æ¿                               â”‚
â”‚ â”‚       $ omo-quota init                                    â”‚
â”‚ â”‚    2. éªŒè¯ç­–ç•¥æ–‡ä»¶çŠ¶æ€                                     â”‚
â”‚ â”‚       $ omo-quota doctor                                  â”‚
â”‚ â”‚    3. æ‰‹åŠ¨æ£€æŸ¥ç­–ç•¥ç›®å½•                                     â”‚
â”‚ â”‚                                                            â”‚
â”‚ â”‚ ğŸ“š å­¦ä¹ æ›´å¤š:                                               â”‚
â”‚ â”‚    https://github.com/xiamingxing/omo-quota#å¿«é€Ÿå¼€å§‹      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®ç°ç»†èŠ‚

- **æ–‡ä»¶**: `src/utils/error-formatter.ts`
- **åŠŸèƒ½**:
  - é”™è¯¯ç±»åˆ«è§†è§‰åŒ–ï¼ˆ6ç§ç±»åˆ«ï¼Œå¯¹åº”ä¸åŒå›¾æ ‡å’Œé¢œè‰²ï¼‰
  - ç»“æ„åŒ–è¾“å‡ºï¼ˆæ ‡é¢˜ã€åŸå› ã€è§£å†³æ–¹æ¡ˆã€å­¦ä¹ é“¾æ¥ï¼‰
  - å†…ç½®è§£å†³æ–¹æ¡ˆåº“ï¼ˆé’ˆå¯¹æ¯ç§é”™è¯¯ç±»å‹ï¼‰
  - æ–‡æ¡£é“¾æ¥åº“

---

## 2. è¿›åº¦åé¦ˆç³»ç»Ÿ (P1)

### ä¼˜åŒ–å‰
```
ğŸ”„ Syncing quota from oh-my-opencode messages...
Scanning: ~/.opencode/messages
âœ“ Found 342 assistant messages
âœ“ Sync completed in 1234ms
```

### ä¼˜åŒ–å
```
[1/5] ğŸ” æ‰«ææ¶ˆæ¯å†å²ç›®å½•...
  âœ“ å®Œæˆ (0.3s)
[2/5] ğŸ“„ è§£æä¼šè¯æ–‡ä»¶... (127/342)
  âœ“ å®Œæˆ (1.2s)
[3/5] ğŸ’° è®¡ç®—æˆæœ¬...
  âœ“ å®Œæˆ (0.1s)
[4/5] ğŸ’¾ æ›´æ–°è¿½è¸ªæ–‡ä»¶...
  âœ“ å®Œæˆ (0.0s)
[5/5] âœ… åŒæ­¥å®Œæˆ!

æ€»è€—æ—¶: 1.67ç§’
```

### å®ç°ç»†èŠ‚

- **æ–‡ä»¶**: `src/utils/progress.ts`
- **åŠŸèƒ½**:
  - `ProgressManager` - å¤šæ­¥éª¤ä»»åŠ¡ç®¡ç†
  - `ProgressBar` - å¯è§†åŒ–è¿›åº¦æ¡
  - `Spinner` - åŠ è½½åŠ¨ç”»
  - æ—¶é—´ä¼°ç®—åŠŸèƒ½
  - ä¾¿æ·å‡½æ•° `runSteps()`, `runWithProgress()`, `runWithSpinner()`

---

## 3. äº¤äº’å¼å¼•å¯¼å‘å¯¼ (P2)

### ä¼˜åŒ–å‰
```
$ omo-quota init
ğŸš€ åˆå§‹åŒ– omo-quota é…é¢ç®¡ç†ç³»ç»Ÿ
âœ… é…é¢è¿½è¸ªæ–‡ä»¶å·²åˆå§‹åŒ–
âœ¨ åˆå§‹åŒ–å®Œæˆ!
```

### ä¼˜åŒ–å
```
$ omo-quota init --wizard

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ‰ æ¬¢è¿ä½¿ç”¨ omo-quotaï¼                        â”‚
â”‚                                                            â”‚
â”‚ omo-quota æ˜¯æ‚¨çš„ AI é…é¢ç®¡ç†åŠ©æ‰‹ï¼Œå¯ä»¥ï¼š                  â”‚
â”‚ â€¢ å®æ—¶è¿½è¸ªå„ AI æ¨¡å‹çš„ä½¿ç”¨é‡                               â”‚
â”‚ â€¢ ä¸€é”®åˆ‡æ¢æ€§èƒ½/å‡è¡¡/ç»æµç­–ç•¥                               â”‚
â”‚ â€¢ è‡ªåŠ¨é¢„è­¦å³å°†è€—å°½çš„é…é¢                                   â”‚
â”‚ â€¢ ç”Ÿæˆè¯¦ç»†çš„æˆæœ¬åˆ†ææŠ¥å‘Š                                   â”‚
â”‚                                                            â”‚
â”‚ ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰ï¼š                                       â”‚
â”‚ 1ï¸âƒ£  omo-quota init     åˆå§‹åŒ–é…ç½®                         â”‚
â”‚ 2ï¸âƒ£  omo-quota status    æŸ¥çœ‹å½“å‰çŠ¶æ€                      â”‚
â”‚ 3ï¸âƒ£  omo-quota switch    é€‰æ‹©æ¨èç­–ç•¥                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“‹ é€‰æ‹©é»˜è®¤ç­–ç•¥:

  1. æè‡´æ€§èƒ½å‹ (Performance) - å…³é”®ä»»åŠ¡
  2. å‡è¡¡å®ç”¨å‹ (Balanced) â­ æ¨è - æ—¥å¸¸å¼€å‘
  3. ç»æµèŠ‚çº¦å‹ (Economical) - å®éªŒé¡¹ç›®

âœ“ æ­£åœ¨åˆå§‹åŒ– omo-quota...
âœ“ å·²åˆ›å»ºé…é¢è¿½è¸ªæ–‡ä»¶...
âœ“ å·²ç”Ÿæˆ 3 ä¸ªç­–ç•¥æ–‡ä»¶...
âœ“ åˆå§‹åŒ–å®Œæˆï¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ¨ åˆå§‹åŒ–å®Œæˆï¼                                            â”‚
â”‚                                                            â”‚
â”‚ ğŸ’¡ ä¸‹ä¸€æ­¥ï¼š                                                â”‚
â”‚ â€¢ omo-quota status    æŸ¥çœ‹é…é¢çŠ¶æ€                         â”‚
â”‚ â€¢ omo-quota list       æŸ¥çœ‹æ‰€æœ‰ç­–ç•¥                        â”‚
â”‚ â€¢ omo-quota switch    åˆ‡æ¢ç­–ç•¥                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®ç°ç»†èŠ‚

- **æ–‡ä»¶**: `src/commands/wizard.ts`
- **åŠŸèƒ½**:
  - æ¬¢è¿ç•Œé¢å’ŒåŠŸèƒ½ä»‹ç»
  - ç­–ç•¥é€‰æ‹©èœå•ï¼ˆå¸¦æ¨èæ ‡ç­¾ï¼‰
  - è‡ªåŠ¨åˆå§‹åŒ–æµç¨‹
  - å®Œæˆåå¿«é€Ÿå…¥é—¨æŒ‡å—
  - `--wizard` æ ‡å¿—é›†æˆåˆ° `init` å‘½ä»¤

---

## 4. æ’¤é”€/é‡åšæœºåˆ¶ (P3)

### ä¼˜åŒ–å‰
```
$ omo-quota switch performance
âœ“ æˆåŠŸåˆ‡æ¢åˆ° performance

# ç”¨æˆ·æ”¹å˜ä¸»æ„... éœ€è¦æ‰‹åŠ¨åˆ‡æ¢å›å»
$ omo-quota switch balanced
âœ“ æˆåŠŸåˆ‡æ¢åˆ° balanced
```

### ä¼˜åŒ–å
```
$ omo-quota switch performance
âœ“ æˆåŠŸåˆ‡æ¢åˆ° performance (æè‡´æ€§èƒ½å‹)

$ omo-quota switch economical
âœ“ æˆåŠŸåˆ‡æ¢åˆ° economical (ç»æµèŠ‚çº¦å‹)

# ç”¨æˆ·æ”¹å˜ä¸»æ„ï¼Œä½¿ç”¨æ’¤é”€
$ omo-quota undo

æ’¤é”€æ“ä½œ:
  æ“ä½œ: åˆ‡æ¢ç­–ç•¥: performance â†’ economical
  æ—¶é—´: 14:30:00

âœ“ æ’¤é”€æˆåŠŸ
å½“å‰ç­–ç•¥: performance
è¯·é‡å¯ OpenCode ä½¿é…ç½®ç”Ÿæ•ˆ

# æŸ¥çœ‹æ“ä½œå†å²
$ omo-quota history

æ“ä½œå†å²:
  å¯æ’¤é”€çš„æ“ä½œ:
    âœ“ 14:30:00 åˆ‡æ¢ç­–ç•¥: performance â†’ economical
```

### å®ç°ç»†èŠ‚

- **æ–‡ä»¶**: `src/utils/undo-stack.ts`, `src/commands/undo.ts`
- **åŠŸèƒ½**:
  - æ“ä½œå†å²è®°å½•ï¼ˆæœ€å¤š10æ¡ï¼‰
  - æ’¤é”€/é‡åšåŠŸèƒ½
  - é…ç½®è‡ªåŠ¨å¤‡ä»½
  - æŒä¹…åŒ–å†å²è®°å½•
  - `history` å‘½ä»¤æŸ¥çœ‹å†å²

---

## 5. ç»Ÿä¸€è¾“å‡ºæ ¼å¼ (P4)

### è®¾è®¡åŸåˆ™

1. **ä¸€è‡´çš„å¸ƒå±€ç»“æ„**:
   - æ ‡é¢˜åŒºåŸŸ (Title)
   - çŠ¶æ€åŒºåŸŸ (Status)
   - æ•°æ®åŒºåŸŸ (Data)
   - æ“ä½œåŒºåŸŸ (Action)
   - å¸®åŠ©åŒºåŸŸ (Help)

2. **ç»Ÿä¸€çš„é…è‰²æ–¹æ¡ˆ**:
   - æˆåŠŸ: ç»¿è‰² (âœ“)
   - è­¦å‘Š: é»„è‰² (âš )
   - é”™è¯¯: çº¢è‰² (âœ—)
   - ä¿¡æ¯: é’è‰² (â—)
   - é™éŸ³: ç°è‰² (â—‹)

3. **å¯è®¿é—®æ€§**:
   - é«˜å¯¹æ¯”åº¦é¢œè‰²
   - æ¸…æ™°çš„è§†è§‰å±‚æ¬¡
   - å›¾æ ‡è¾…åŠ©ç†è§£

### å®ç°ç»†èŠ‚

- **æ–‡ä»¶**: `src/utils/output-formatter.ts`
- **åŠŸèƒ½**:
  - `OutputFormatter` ç±» - ç»Ÿä¸€æ ¼å¼åŒ–å™¨
  - é¢„è®¾æ¨¡æ¿ (`successTemplate`, `errorTemplate`, `warningTemplate`)
  - é…é¢çŠ¶æ€æ¡æ˜¾ç¤º
  - æ—¶é—´æ ¼å¼åŒ–
  - ä¾¿æ·å‡½æ•° (`showStatus`, `showActions`, `showOutput`)

---

## é›†æˆåˆ°ç°æœ‰å‘½ä»¤

ä»¥ä¸‹å‘½ä»¤å·²æ›´æ–°ä»¥ä½¿ç”¨æ–°çš„UXç»„ä»¶ï¼š

| å‘½ä»¤ | æ–°å¢åŠŸèƒ½ |
|------|----------|
| `omo-quota init` | æ·»åŠ  `--wizard` é€‰é¡¹ |
| `omo-quota switch` | è®°å½•æ“ä½œå†å²ï¼Œæ”¯æŒæ’¤é”€ |
| `omo-quota undo` | æ–°å¢å‘½ä»¤ï¼Œæ’¤é”€æ“ä½œ |
| `omo-quota sync` | å¯ä½¿ç”¨è¿›åº¦åé¦ˆ |
| æ‰€æœ‰å‘½ä»¤ | å¯ä½¿ç”¨ç»Ÿä¸€è¾“å‡ºæ ¼å¼ |

---

## ä½¿ç”¨ç¤ºä¾‹

### 1. ä½¿ç”¨å‘å¯¼åˆå§‹åŒ–

```bash
omo-quota init --wizard
```

### 2. æ’¤é”€ç­–ç•¥åˆ‡æ¢

```bash
# åˆ‡æ¢ç­–ç•¥
omo-quota switch performance

# æ”¹å˜ä¸»æ„
omo-quota switch economical

# æ’¤é”€åˆ°ä¸Šä¸€ä¸ªç­–ç•¥
omo-quota undo

# æŸ¥çœ‹å†å²
omo-quota history
```

### 3. ä½¿ç”¨è¿›åº¦åé¦ˆï¼ˆå¼€å‘è€…ï¼‰

```typescript
import { runSteps, ProgressManager } from './utils/progress';

// æ–¹å¼1: ä½¿ç”¨ä¾¿æ·å‡½æ•°
await runSteps([
  { name: 'æ‰«ææ–‡ä»¶', fn: async () => { /* ... */ } },
  { name: 'è§£ææ•°æ®', fn: async () => { /* ... */ } },
  { name: 'ä¿å­˜ç»“æœ', fn: async () => { /* ... */ } },
]);

// æ–¹å¼2: æ‰‹åŠ¨æ§åˆ¶
const progress = new ProgressManager(['æ­¥éª¤1', 'æ­¥éª¤2', 'æ­¥éª¤3']);
progress.start(0);
// ... æ‰§è¡Œæ“ä½œ
progress.complete(0);
progress.start(1);
// ...
```

### 4. ä½¿ç”¨ç»Ÿä¸€è¾“å‡ºæ ¼å¼

```typescript
import { showOutput, successTemplate } from './utils/output-formatter';

// æ–¹å¼1: å®Œæ•´è¾“å‡º
showOutput({
  title: 'é…é¢åŒæ­¥å®Œæˆ',
  titleIcon: 'âœ…',
  status: [
    { label: 'å¤„ç†æ¶ˆæ¯', value: '342', status: 'success' },
    { label: 'è€—æ—¶', value: '1.67s', status: 'info' },
  ],
  actions: [
    { label: 'æŸ¥çœ‹çŠ¶æ€', command: 'omo-quota status' },
  ],
});

// æ–¹å¼2: ä½¿ç”¨é¢„è®¾æ¨¡æ¿
successTemplate('åŒæ­¥å®Œæˆ', 'å·²å¤„ç† 342 æ¡æ¶ˆæ¯', [
  { label: 'æŸ¥çœ‹è¯¦æƒ…', command: 'omo-quota status' },
]);
```

---

## ç”¨æˆ·æµ‹è¯•è®¡åˆ’

### æµ‹è¯•åœºæ™¯

1. **é¦–æ¬¡ä½¿ç”¨**
   - è¿è¡Œ `omo-quota init --wizard`
   - è§‚å¯Ÿå¼•å¯¼æ˜¯å¦æ¸…æ™°
   - æ£€æŸ¥ç­–ç•¥é€‰æ‹©æ˜¯å¦ç›´è§‚

2. **é”™è¯¯å¤„ç†**
   - æ•…æ„è¾“å…¥é”™è¯¯çš„ç­–ç•¥åç§°
   - åˆ é™¤ç­–ç•¥æ–‡ä»¶åæ‰§è¡Œå‘½ä»¤
   - æ£€æŸ¥é”™è¯¯æ¶ˆæ¯æ˜¯å¦å¯ç†è§£

3. **è¿›åº¦åé¦ˆ**
   - è¿è¡Œ `omo-quota sync --verbose`
   - è§‚å¯Ÿè¿›åº¦æ˜¾ç¤ºæ˜¯å¦æ¸…æ™°
   - æ£€æŸ¥æ—¶é—´ä¼°ç®—æ˜¯å¦åˆç†

4. **æ’¤é”€åŠŸèƒ½**
   - æ‰§è¡Œå¤šæ¬¡ç­–ç•¥åˆ‡æ¢
   - ä½¿ç”¨ `omo-quota undo` æ’¤é”€
   - æ£€æŸ¥æ¢å¤æ˜¯å¦æ­£ç¡®

### æ”¶é›†åé¦ˆ

- é”™è¯¯æ¶ˆæ¯çš„å¯ç†è§£æ€§
- å¼•å¯¼å‘å¯¼çš„æ˜“ç”¨æ€§
- è¿›åº¦åé¦ˆçš„æœ‰ç”¨æ€§
- æ•´ä½“æ»¡æ„åº¦

---

## åç»­ä¼˜åŒ–å»ºè®®

1. **äº¤äº’å¼è¾“å…¥å¢å¼º**
   - ä½¿ç”¨ `inquirer` æˆ–ç±»ä¼¼åº“å®ç°çœŸæ­£çš„äº¤äº’å¼è¾“å…¥
   - æ”¯æŒä¸Šä¸‹é”®é€‰æ‹©ç­–ç•¥

2. **æ›´å¤šæ’¤é”€æ”¯æŒ**
   - æ”¯æŒæ’¤é”€ `reset` å’Œ `update` æ“ä½œ
   - æ·»åŠ  `--dry-run` é¢„è§ˆæ¨¡å¼

3. **è¿›åº¦åé¦ˆå¢å¼º**
   - æ·»åŠ  ETA æ˜¾ç¤º
   - æ”¯æŒæµå¼è¾“å‡º

4. **å›½é™…åŒ–æ”¯æŒ**
   - æ·»åŠ è‹±æ–‡è¯­è¨€åŒ…
   - æ”¯æŒè¯­è¨€åˆ‡æ¢

---

## æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | æè¿° |
|------|------|
| `src/utils/error-formatter.ts` | ç»“æ„åŒ–é”™è¯¯æ ¼å¼åŒ–å™¨ |
| `src/utils/progress.ts` | è¿›åº¦åé¦ˆç³»ç»Ÿ |
| `src/commands/wizard.ts` | äº¤äº’å¼å¼•å¯¼å‘å¯¼ |
| `src/utils/undo-stack.ts` | æ’¤é”€/é‡åšæœºåˆ¶ |
| `src/commands/undo.ts` | undo å‘½ä»¤å®ç° |
| `src/utils/output-formatter.ts` | ç»Ÿä¸€è¾“å‡ºæ ¼å¼åŒ–å™¨ |

---

**ä¼˜åŒ–å®Œæˆæ—¥æœŸ**: 2026-01-31
**ä¼˜åŒ–ç‰ˆæœ¬**: v2.0.0-ux
